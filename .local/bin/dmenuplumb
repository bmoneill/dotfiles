#!/bin/sh
# plumbing script for x11

prim="$(xclip -o)"; [ -z "$prim" ] && exit
[ -f "$prim" ] && xdg-open "$prim" && exit
[ -d "$prim" ] && "$TERMINAL" "$prim" && exit

# global funcs
websearch() { searx $@; }
wikipedia() { $TERMINAL wikicurses "$@"; }
maps() { osm $@; }
ebaysearch() { ebay $@; }

manual() { man -Tps "$@" | zathura -; }
gotourl() { "$BROWSER" "$@"; }
mailto() { "$EMAIL" "$@"; }

opts="websearch wikipedia maps ebaysearch"

man -k "$prim" >/dev/null 2>/dev/null && opts="$opts manual"
[ ! -z "$(echo "$prim" | sed -n '/http[s]*:.*/p')" ] && opts="$opts gotourl"
[ ! -z "$(echo "$prim" | sed -n '/.*@.*\..*/p')" ] && opts="$opts mailto"

# actual menu
res=$(echo $opts | tr ' ' '\n' | dmenu -p "plumb:" -l 10)

[ -z $res ] && exit

$res $prim
